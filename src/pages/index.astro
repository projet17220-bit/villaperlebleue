---
const lang = Astro.url.searchParams.get('lang') || 'fr';

const t = lang === 'fr' ? {
  title: "Villa La Perle Bleue",
  hero_desc: "Séjournez dans une villa moderne et paisible près de La Rochelle. Jusqu'à 10 personnes.",
  prix: "À partir de 350€/nuit (min. 3 nuits)",
  dispo: "Disponibilités",
  resa: "Demander une réservation",
  annulation: "Annulation gratuite jusqu'à 30 jours avant. 50% de frais ensuite.",
  paiement: "Paiement par virement bancaire après validation manuelle.",
  confort: "Confort & divertissement"
} : {
  title: "Villa La Perle Bleue",
  hero_desc: "Modern peaceful villa near La Rochelle. Up to 10 guests.",
  prix: "From 350€/night (min. 3 nights)",
  dispo: "Availability",
  resa: "Request booking",
  annulation: "Free cancellation up to 30 days. 50% fee after.",
  paiement: "Bank transfer after manual approval.",
  confort: "Comfort & entertainment"
};

const indisponibles = ['14','15','20'];
---

<!doctype html>
<html lang={lang}>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{t.title}</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 font-['Inter'] antialiased min-h-screen">

<style>
  /* CARROUSEL CORRIGÉ : Une seule image visible à la fois */
  .carousel-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.8s ease-in-out;
  }
  .carousel-img.active { opacity: 1; }
  
  .card-hover { 
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
  }
  .card-hover:hover { 
    transform: translateY(-8px) scale(1.01); 
    box-shadow: 0 25px 50px rgba(0,0,0,0.12); 
  }
</style>

<!-- Toggle FR/EN -->
<nav class="fixed top-4 right-4 z-50 bg-white/95 backdrop-blur-xl shadow-xl rounded-2xl p-2 border md:top-6 md:right-6">
  <a href="?lang=fr" class={`px-4 py-2 rounded-xl font-semibold text-xs md:text-sm tracking-wide transition-all ${lang === 'fr' ? 'bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg' : 'hover:bg-blue-50 text-gray-700'}`}>FR</a>
  <a href="?lang=en" class={`px-4 py-2 rounded-xl font-semibold text-xs md:text-sm tracking-wide ml-1 md:ml-2 transition-all ${lang === 'en' ? 'bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg' : 'hover:bg-blue-50 text-gray-700'}`}>EN</a>
</nav>

<!-- HERO CARROUSEL CORRIGÉ (6 images, contrôles + auto) -->
<section class="relative h-[45vh] md:h-[60vh] lg:h-[65vh] overflow-hidden bg-black">
  <div id="carousel" class="relative w-full h-full">
    <!-- Images CARROUSEL (seule l'active est visible) -->
    <img src="/hero.jpeg" alt="Villa La Perle Bleue" class="carousel-img active" data-index="0" />
    <img src="/chaiseslongues.jpeg" alt="Chaises longues piscine" class="carousel-img" data-index="1" />
    <img src="/pingpong.jpeg" alt="Table ping-pong" class="carousel-img" data-index="2" />
    <img src="/piscinenuit.jpeg" alt="Piscine nuit" class="carousel-img" data-index="3" />
    <img src="/salon1.jpeg" alt="Salon lumineux" class="carousel-img" data-index="4" />
    <img src="/salonvuetable.jpeg" alt="Salon vue table" class="carousel-img" data-index="5" />
  </div>

  <!-- Contenu hero -->
  <div class="absolute inset-0 bg-gradient-to-t from-black/75 via-black/40 to-transparent flex flex-col justify-center items-center text-white text-center px-4 md:px-6 z-20">
    <h1 class="text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-black mb-3 md:mb-4 bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent drop-shadow-2xl">
      {t.title}
    </h1>
    <p class="text-sm md:text-base lg:text-lg mb-6 md:mb-8 max-w-xl md:max-w-2xl leading-relaxed opacity-95 font-medium">
      {t.hero_desc}
    </p>
    <div class="bg-white/20 backdrop-blur-xl p-5 md:p-6 lg:p-8 rounded-2xl shadow-2xl border border-white/30">
      <p class="text-xl md:text-2xl lg:text-3xl font-black mb-3 md:mb-4 text-yellow-300 drop-shadow-lg">{t.prix}</p>
      <a href="#resa" class="inline-block bg-gradient-to-r from-emerald-500 to-emerald-600 hover:from-emerald-600 hover:to-emerald-700 text-white px-6 md:px-10 py-3 md:py-4 rounded-xl md:rounded-2xl font-bold text-base md:text-lg shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all duration-500">
        {t.resa}
      </a>
    </div>
  </div>

  <!-- Indicateurs + Contrôles -->
  <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2 z-30">
    <button onclick="changeSlide(-1)" class="w-2 h-2 md:w-3 md:h-3 bg-white/50 rounded-full hover:bg-white transition-all duration-300 carousel-dot" data-active="false"></button>
    <button onclick="changeSlide(-1)" class="w-2 h-2 md:w-3 md:h-3 bg-white rounded-full shadow-lg carousel-dot" data-active="true"></button>
    <button onclick="changeSlide(1)" class="w-2 h-2 md:w-3 md:h-3 bg-white/50 rounded-full hover:bg-white transition-all duration-300 carousel-dot" data-active="false"></button>
    <button onclick="changeSlide(1)" class="w-2 h-2 md:w-3 md:h-3 bg-white/50 rounded-full hover:bg-white transition-all duration-300 carousel-dot" data-active="false"></button>
    <button onclick="changeSlide(1)" class="w-2 h-2 md:w-3 md:h-3 bg-white/50 rounded-full hover:bg-white transition-all duration-300 carousel-dot" data-active="false"></button>
    <button onclick="changeSlide(1)" class="w-2 h-2 md:w-3 md:h-3 bg-white/50 rounded-full hover:bg-white transition-all duration-300 carousel-dot" data-active="false"></button>
  </div>

  <!-- Flèches navigation (optionnel) -->
  <button onclick="changeSlide(-1)" class="absolute left-4 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/40 w-12 h-12 rounded-full flex items-center justify-center text-2xl font-bold backdrop-blur-xl z-30 md:w-14 md:h-14 transition-all duration-300">‹</button>
  <button onclick="changeSlide(1)" class="absolute right-4 top-1/2 -translate-y-1/2 bg-white/20 hover:bg-white/40 w-12 h-12 rounded-full flex items-center justify-center text-2xl font-bold backdrop-blur-xl z-30 md:w-14 md:h-14 transition-all duration-300">›</button>
</section>

<!-- Contenu principal (identique version précédente, compact) -->
<main class="max-w-6xl mx-auto px-4 md:px-6 py-12 md:py-16 lg:py-20 space-y-16 md:space-y-20">

  <!-- Équipements -->
  <section class="text-center">
    <h2 class="text-4xl md:text-5xl font-black mb-12 md:mb-16 bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent">{t.confort}</h2>
    <div class="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8">
      <div class="group p-6 md:p-10 bg-white/80 backdrop-blur-xl rounded-2xl md:rounded-3xl shadow-xl border border-white/50 card-hover">
        <div class="w-20 h-20 md:w-24 md:h-24 bg-gradient-to-br from-blue-
